{"graphData":{"nodes":[{"id":"process_start3323291255645","component_id":"process_start","version":"2.1.0","module_category":"common","module":"ProcessStart","module_path":"code.index","name":"流程开始","description":"流程开始","language":"python","ui_type":"start_view","dependencies":{},"properties":[{"type":"base_params","name":"基本","params":[{"id":"show_name","grade":"basic","name":"显示名称","panel_text":"流程开始执行","show":true,"show_type":"text","value_type":"String","value":"\"流程开始\"","length":32,"required":false,"tips":"流程开始组件名称"}]}],"annotation":"","left":1233.2000122070312,"top":120,"groupId":"","right_endpoint":"bf_endpoint_process_start3323291255645rt","left_endpoint":"bf_endpoint_process_start3323291255645lf","top_endpoint":"bf_endpoint_process_start3323291255645tp","bottom_endpoint":"bf_endpoint_process_start3323291255645bm"},{"id":"script_python_execute5168395923289","version":"2.1.0","module_category":"common","module":"ScriptPythonExecute","module_path":"code.index","name":"执行python脚本","description":"执行python脚本","language":"python","ui_type":"param_view","dependencies":{},"properties":[{"type":"base_params","name":"基本","params":[{"id":"show_name","grade":"basic","name":"显示名称","panel_text":"执行python脚本","show":true,"show_type":"text","value_type":"String","value":"\"运行日志初始化\"","length":32,"required":false,"tips":"显示名称，组件面板显示标题"},{"id":"continue_on_error","grade":"senior","name":"错误执行","show":true,"show_type":"singleSelect","value_type":"String","value":"\"False\"","required":false,"tips":"组件运行错误时，是否继续执行","options":[{"label":"是","value":"\"True\""},{"label":"否","value":"\"False\""}]},{"id":"before_delay","grade":"senior","name":"活动前延迟时间(毫秒)","show":true,"show_type":"text","value_type":"int","value":"300","length":8,"required":false,"tips":"活动前延迟时间(毫秒)，默认延迟300毫秒"},{"id":"after_delay","grade":"senior","name":"活动后延迟时间(毫秒)","show":true,"show_type":"text","value_type":"int","value":"300","length":8,"required":false,"tips":"活动后延迟时间(毫秒)，默认延迟300毫秒"},{"id":"asyn","grade":"senior","name":"异步","show":false,"show_type":"singleSelect","value_type":"String","value":"\"False\"","required":false,"tips":"组件运行是否异步运行","options":[{"label":"是","value":"\"True\""},{"label":"否","value":"\"False\""}]}]},{"type":"input_params","name":"输入","params":[{"id":"msg_pipe","grade":"basic","name":"消息管道","placeholder":"","show":false,"show_type":"text","value_type":"Object","value":"","required":true,"tips":"组件与执行器之间的通信管道，，由执行器隐式传参","is_implicit":true},{"id":"python_env","grade":"senior","name":"执行环境","placeholder":"","show":true,"show_type":"singleSelect","value_type":"String","value":"\"inner_python\"","required":false,"options":[{"label":"内置","value":"\"inner_python\""},{"label":"本地python","value":"\"native_python\""},{"label":"本地python3","value":"\"native_python_three\""},{"label":"本地自定义","value":"\"native_python_define\""}],"tips":"选择要执行Python脚本的环境，默认使用内置python环境，选择本地python表示通过本地python命令执行脚本，选择本地python3表示通过本地python3命令执行脚本"},{"id":"_native_python_command","grade":"senior","name":"本地python命令","placeholder":"\"python3.8\"","show":false,"show_bind":{"python_env":["native_python_define"]},"show_type":"text","value_type":"String","value":"\"python3.8\"","required":false,"tips":"如果执行环境选择本地自定义，则需要填写对应本地自定义python命令，例如：填写python3.8，表示通过本地python3.8命令执行脚本"},{"id":"python_script","grade":"basic","name":"python脚本","placeholder":"","show":true,"show_type":"pythonEditor","value_type":"immutable","value":"import os\r\nfrom datetime import datetime, timedelta\r\nimport logging\r\n\r\n#项目路径\r\ndate_day = datetime.today().strftime('%Y-%m-%d')\r\n# basic_path = r\"C:\\project\\python_project\\ai稽核\"\r\n# 日志配置\r\nlog_path = os.path.join(basic_path, 'logs')\r\nif not os.path.exists(log_path):\r\n    os.makedirs(log_path)\r\n\r\nlog_formatter = logging.Formatter('%(asctime)s %(levelname)s: %(message)s')\r\nroot_logger = logging.getLogger()\r\nroot_logger.setLevel(logging.DEBUG)\r\n\r\nlog_file_handler = logging.FileHandler(\r\n    filename=os.path.join(log_path, f\"{datetime.now().strftime('%Y-%m-%d')}.log\"), mode='a', encoding='utf-8')\r\nlog_file_handler.setFormatter(log_formatter)\r\nroot_logger.addHandler(log_file_handler)","required":true,"tips":"需要执行的python脚本，脚本注意事项：\n1、脚本中的反斜杆\\需要转义写成\\\\ \n2、脚本中不能使用main()方法\n3、脚本示例：\ndef add(a,b):\n    return a+b\nc=add(param1,param2)\n入参定义：param1=1,param2=2\n出参定义：c=my_result\n脚本执行后输出的结果3将赋值给变量my_result"},{"id":"python_input_variables","grade":"basic","name":"入参定义","placeholder":"","show":true,"show_type":"dict","value_type":"dict","value":{"basic_path":"basic_path"},"required":false,"tips":"如果执行的python脚本需要入参，则需要传入参数，以key-value的形式填写，key是脚本里面的入参，value是对应入参的值"}]},{"type":"output_params","name":"输出","params":[{"id":"_script_execute_result","grade":"basic","name":"出参定义","show":true,"show_type":"dict","value_type":"dict","value":{},"required":false,"tips":"如果执行的python脚本需要输出结果，则需要定义变量接收，以key-value的形式填写，key为脚本中的出参，value为在设计器中定义变量"}]}],"component_id":"script_python_execute","left":1184,"top":207,"annotation":"","right_endpoint":"bf_endpoint_script_python_execute5168395923289rt","left_endpoint":"bf_endpoint_script_python_execute5168395923289lf","top_endpoint":"bf_endpoint_script_python_execute5168395923289tp","bottom_endpoint":"bf_endpoint_script_python_execute5168395923289bm","groupId":"","endpointVertical":true},{"id":"script_python_execute0068589452115","version":"2.1.0","module_category":"common","module":"ScriptPythonExecute","module_path":"code.index","name":"执行python脚本","description":"执行python脚本","language":"python","ui_type":"param_view","dependencies":{},"properties":[{"type":"base_params","name":"基本","params":[{"id":"show_name","grade":"basic","name":"显示名称","panel_text":"执行python脚本","show":true,"show_type":"text","value_type":"String","value":"\"项目初始化\"","length":32,"required":false,"tips":"显示名称，组件面板显示标题"},{"id":"continue_on_error","grade":"senior","name":"错误执行","show":true,"show_type":"singleSelect","value_type":"String","value":"\"False\"","required":false,"tips":"组件运行错误时，是否继续执行","options":[{"label":"是","value":"\"True\""},{"label":"否","value":"\"False\""}]},{"id":"before_delay","grade":"senior","name":"活动前延迟时间(毫秒)","show":true,"show_type":"text","value_type":"int","value":"300","length":8,"required":false,"tips":"活动前延迟时间(毫秒)，默认延迟300毫秒"},{"id":"after_delay","grade":"senior","name":"活动后延迟时间(毫秒)","show":true,"show_type":"text","value_type":"int","value":"300","length":8,"required":false,"tips":"活动后延迟时间(毫秒)，默认延迟300毫秒"},{"id":"asyn","grade":"senior","name":"异步","show":false,"show_type":"singleSelect","value_type":"String","value":"\"False\"","required":false,"tips":"组件运行是否异步运行","options":[{"label":"是","value":"\"True\""},{"label":"否","value":"\"False\""}]}]},{"type":"input_params","name":"输入","params":[{"id":"msg_pipe","grade":"basic","name":"消息管道","placeholder":"","show":false,"show_type":"text","value_type":"Object","value":"","required":true,"tips":"组件与执行器之间的通信管道，，由执行器隐式传参","is_implicit":true},{"id":"python_env","grade":"senior","name":"执行环境","placeholder":"","show":true,"show_type":"singleSelect","value_type":"String","value":"\"inner_python\"","required":false,"options":[{"label":"内置","value":"\"inner_python\""},{"label":"本地python","value":"\"native_python\""},{"label":"本地python3","value":"\"native_python_three\""},{"label":"本地自定义","value":"\"native_python_define\""}],"tips":"选择要执行Python脚本的环境，默认使用内置python环境，选择本地python表示通过本地python命令执行脚本，选择本地python3表示通过本地python3命令执行脚本"},{"id":"_native_python_command","grade":"senior","name":"本地python命令","placeholder":"\"python3.8\"","show":false,"show_bind":{"python_env":["native_python_define"]},"show_type":"text","value_type":"String","value":"\"python3.8\"","required":false,"tips":"如果执行环境选择本地自定义，则需要填写对应本地自定义python命令，例如：填写python3.8，表示通过本地python3.8命令执行脚本"},{"id":"python_script","grade":"basic","name":"python脚本","placeholder":"","show":true,"show_type":"pythonEditor","value_type":"immutable","value":"import os\r\nfrom datetime import datetime, timedelta\r\nimport logging\r\n\r\n# 获取当前年月\r\ncurrent_date = datetime.now()\r\nyear_suffix = str(current_date.year)[2:]  # 获取年份后两位\r\nmonth = current_date.month\r\nday = current_date.day\r\nproject_path = rf\"{basic_path}\\{year_suffix}年{month}月{day}日数据\"\r\nif not os.path.exists(project_path):\r\n    os.makedirs(project_path)\r\n    logging.info(\"文件夹创建成功\")\r\n\r\nfile_path_待调剂明细数据 = rf\"{project_path}\\待调剂明细数据.xlsx\"\r\nfile_path_待调剂数据 = rf\"{project_path}\\待调剂数据.xlsx\"\r\nfile_path_降档报表 = rf\"{project_path}\\降档报表.xlsx\"\r\nfile_path_渠道档案报表 = rf\"{project_path}\\渠道档案报表.xlsx\"\r\nfile_path_费用结算数据稽核 = rf\"{project_path}\\关于{year_suffix}年{month}月费用结算数据稽核.xlsx\"\r\nfile_path_制表取数表 = rf\"{project_path}\\制表取数表.xlsx\"\r\nlogging.info(\"文件初始化完成\")","required":true,"tips":"需要执行的python脚本，脚本注意事项：\n1、脚本中的反斜杆\\需要转义写成\\\\ \n2、脚本中不能使用main()方法\n3、脚本示例：\ndef add(a,b):\n    return a+b\nc=add(param1,param2)\n入参定义：param1=1,param2=2\n出参定义：c=my_result\n脚本执行后输出的结果3将赋值给变量my_result"},{"id":"python_input_variables","grade":"basic","name":"入参定义","placeholder":"","show":true,"show_type":"dict","value_type":"dict","value":{"basic_path":"basic_path"},"required":false,"tips":"如果执行的python脚本需要入参，则需要传入参数，以key-value的形式填写，key是脚本里面的入参，value是对应入参的值"}]},{"type":"output_params","name":"输出","params":[{"id":"_script_execute_result","grade":"basic","name":"出参定义","show":true,"show_type":"dict","value_type":"dict","value":{"file_path_待调剂明细数据待调剂明细数据":"file_path_待调剂明细数据待调剂明细数据","project_path":"project_path","file_path_待调剂数据":"file_path_待调剂数据","file_path_降档报表":"file_path_降档报表","file_path_渠道档案报表":"file_path_渠道档案报表","file_path_费用结算数据稽核":"file_path_费用结算数据稽核","file_path_制表取数表":"file_path_制表取数表"},"required":false,"tips":"如果执行的python脚本需要输出结果，则需要定义变量接收，以key-value的形式填写，key为脚本中的出参，value为在设计器中定义变量"}]}],"component_id":"script_python_execute","left":1181.5999755859375,"top":335,"annotation":"","right_endpoint":"bf_endpoint_script_python_execute0068589452115rt","left_endpoint":"bf_endpoint_script_python_execute0068589452115lf","top_endpoint":"bf_endpoint_script_python_execute0068589452115tp","bottom_endpoint":"bf_endpoint_script_python_execute0068589452115bm","groupId":"","endpointVertical":true}],"edges":[{"id":"bf_endpoint_process_start3323291255645bm-bf_endpoint_script_python_execute5168395923289tp","sourceNode":"process_start3323291255645","targetNode":"script_python_execute5168395923289","source":"bf_endpoint_process_start3323291255645bm","target":"bf_endpoint_script_python_execute5168395923289tp","shapeType":"AdvancedBezier","groupUnExpand":false},{"id":"bf_endpoint_script_python_execute5168395923289bm-bf_endpoint_script_python_execute0068589452115tp","sourceNode":"script_python_execute5168395923289","targetNode":"script_python_execute0068589452115","source":"bf_endpoint_script_python_execute5168395923289bm","target":"bf_endpoint_script_python_execute0068589452115tp","shapeType":"AdvancedBezier","groupUnExpand":false}],"groups":[]},"global_vars":[],"blocks":[],"sequences":[],"processInfo":{"is_main_process":false,"process_path":"参数初始化.json","process_name":"参数初始化","process_id":"子流程_DuoTCSYYH","create_at":"2025-04-23 16:03:27","update_at":"2025-04-23 16:03:27","isShow":true,"arch":"Windows","env":"common","designer_version":"2.1.4.19","executor_version":""}}
